%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Supplementary Materials - Frontiers Format
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[utf8]{frontiers_suppmat}
\usepackage{url,hyperref,lineno,microtype}
\usepackage{natbib}
\usepackage[onehalfspacing]{setspace}
\usepackage{float}
\usepackage{multirow}
\usepackage{graphicx}

\def\keyFont{\fontsize{8}{11}\helveticabold}

\begin{document}
\onecolumn
\firstpage{1}

\title{Supplementary Materials:\\France-wide 10\,m Deciduous–Evergreen Mapping: AlphaEarth Embeddings vs Harmonics}

\maketitle

\section{S0. Overview and Linkage to Main Text}

This supplement complements the methods and results in the main manuscript. Cross-references indicate where expanded details live:

\begin{itemize}
    \item S1–S2 expand Section "Methods" on Harmonic-14 design and justify the two-harmonic choice referenced in the main text (see Methods: Harmonic-14).
    \item S3 provides additional details for the Embedding–Harmonic similarity analysis discussed in the main text (Embedding–Harmonic Similarity Analysis).
    \item S4 documents eco-region folds, sampling, and weighting referenced in Methods (Cross-validation) and used throughout evaluation.
    \item S5 consolidates implementation specifics for feature extraction, models, and compute requirements referenced in Methods (Forest Mask/Implementation).
    \item S6 lists extended validation metrics complementing headline accuracies in Results.
    \item S7 reports data/code availability; S8 gathers background citations for geospatial foundation models.
    \item S9 contains product-comparison maps and eco-region tables referred to by "Comparison with Existing Products".
\end{itemize}

\section{S1. Recursive Feature Elimination with Cross-Validation}

\subsection{Methodology}
We employed Recursive Feature Elimination with Cross-Validation (RFECV) to identify optimal feature subsets for both harmonic and embedding approaches:

\begin{enumerate}
    \item \textbf{Harmonic features}: Started with 32 features from two-harmonic Fourier decomposition of NDVI, NBR, CRSWIR, and EVI indices
    \item \textbf{Cross-validation}: Eco-region stratified 5-fold CV maintaining regional representation
    \item \textbf{Optimization}: Iteratively removed features with lowest Random Forest importance scores
    \item \textbf{Selection}: Identified 14 features as optimal balance between performance and computational efficiency
\end{enumerate}

\subsection{Selected Features}
\textbf{Harmonic-14 features:}
\begin{itemize}
    \item NDVI: amplitude\_h1, phase\_cos\_h1, phase\_sin\_h1, offset
    \item NBR: amplitude\_h1, amplitude\_h2, phase\_cos\_h1, offset
    \item CRSWIR: amplitude\_h1, phase\_sin\_h1, offset, var\_residual
    \item EVI: amplitude\_h1, offset
\end{itemize}

\textbf{Emb-14 features:} Selected via RFECV from the 64 embedding bands. The definitive list used in training and similarity analysis is stored with the artifacts: \texttt{results/feature\_selection\_embeddings/features\_embeddings\_topk\_k14.txt} (on Jean Zay: \texttt{$WORK/S2-Tree-Phenology/results/feature\_selection\_embeddings/features\_embeddings\_topk\_k14.txt}).

Performance plateaued beyond 14 features with marginal gains (<0.3 pp) not justifying 56\% additional computational cost.

\section{S2. Optimal Harmonic Configuration}

\subsection{Why Two Harmonics?}
Selecting the appropriate number of harmonics balances phenological signal capture against noise overfitting. Our systematic analysis across 14.1M French forest pixels revealed that two harmonics optimally represents forest phenology (Figure S\ref{fig:harmonic_reconstruction}). The formal decomposition used in the main study is given in Methods (Harmonic feature construction).

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/harmonic_comparison.png}
    \caption{\textbf{Figure S1.} Harmonic reconstruction of NDVI time series for a deciduous pixel. One harmonic captures basic seasonality but forces unrealistic symmetry. Two harmonics reveal the characteristic asymmetric pattern of deciduous forests (rapid spring green-up, gradual autumn senescence). Three harmonics begin fitting atmospheric noise and registration artifacts rather than genuine phenological patterns. Parameters shown: $M_n$ = amplitude for harmonic $n$, $\varphi_n$ = phase, $C$ = offset.}
    \label{fig:harmonic_reconstruction}
\end{figure}

A single harmonic forces symmetric spring and autumn transitions—biologically unrealistic for deciduous species which typically show rapid spring flush followed by gradual decline. The second harmonic enables asymmetric representation matching observed phenology. The third harmonic provides diminishing returns, primarily fitting noise rather than signal.

\subsection{Performance Metrics by Configuration}

Table S\ref{tab:harmonic_metrics} quantifies performance differences across configurations. Deciduous forests show higher signal-to-noise ratios (SNR) and concentrate more energy in the first harmonic (91.1\% vs 76.1\% for evergreen), reflecting their pronounced seasonality. Evergreen forests require more energy in higher harmonics to capture subtle variations.

\begin{table}[H]
    \centering
    \caption{\textbf{Table S1.} Performance metrics for harmonic configurations by phenology type}
    \begin{tabular}{llccccc}
        \hline
        \textbf{Config.} & \textbf{Phenology} & \textbf{SNR$_{dB}$} & \textbf{IQR} & \textbf{E$_1$ (\%)} & \textbf{E$_2$ (\%)} & \textbf{E$_3$ (\%)} \\
        \hline
        \multirow{2}{*}{1 Harmonic}
            & Deciduous & 8.74 & 5.84 & 100.0 & -- & -- \\
            & Evergreen & 1.30 & 8.77 & 100.0 & -- & -- \\
        \hline
        \multirow{2}{*}{2 Harmonics}
            & Deciduous & 10.23 & 5.94 & 91.1 & 8.9 & -- \\
            & Evergreen & 4.20 & 9.52 & 76.1 & 23.9 & -- \\
        \hline
        \multirow{2}{*}{3 Harmonics}
            & Deciduous & 13.34 & 8.56 & 69.5 & 15.7 & 14.8 \\
            & Evergreen & 6.06 & 10.77 & 61.6 & 25.3 & 13.1 \\
        \hline
    \end{tabular}
    \label{tab:harmonic_metrics}
    \vspace{2mm}
    \small{SNR: Signal-to-noise ratio (median); IQR: Interquartile range; E$_n$: Energy percentage in harmonic $n$}
\end{table}

While three harmonics show higher median SNR, the increased variability (IQR) and energy redistribution indicates overfitting. In mountainous regions, the third harmonic primarily captures topographic and atmospheric artifacts rather than phenology.

\section{S3. Embedding–Harmonic Alignment Details}

The main text reports linear alignment between embedding bands and harmonic descriptors. Here we provide configuration details to support reproducibility:

- Ridge regression with standardized predictors; alpha selected via nested tile-stratified CV (grid: $10^{-3}$, $10^{-2}$, $10^{-1}$, $1$, $10$, $10^2$, $10^3$).
- GroupKFold by 2.5\,km tiles (5 splits) to prevent spatial leakage; eco-region weights applied during scoring.
- Response: each embedding band in Emb-14; predictors: the full 22-feature harmonic base prior to RFECV selection.
- Metrics: out-of-sample weighted $R^2$ and absolute Pearson correlation with top-correlated harmonic per eco-region.
- Implementation: \texttt{src/analysis/compute\_embedding\_harmonic\_similarity.py}; outputs under \texttt{results/analysis\_similarity/}.

This analysis supports interpretability claims in the main text by demonstrating systematic correlations with seasonal amplitude and baseline offsets across eco-regions. In the updated results, absolute correlations typically fall in the 0.5–0.7 range for first-harmonic amplitudes (NDVI/NBR) and CRSWIR offsets in multiple regions, while mean linear $R^2$ remains negative across regions (average of the per‑region means: −0.513)—indicating that embeddings encode additional spatial–contextual information beyond the harmonic base. Mediterranean regions also show notable NDVI phase\_h1 alignment, consistent with timing differences under drought stress.

Component summary across regions:
\begin{itemize}
    \item \textbf{amplitude\_h1} dominates (mean |r| $\approx$ 0.498 across 16 region-uses) — largely NDVI/NBR.
    \item \textbf{offset} follows (mean |r| $\approx$ 0.440 across 19 region-uses) — CRSWIR and NBR baselines.
    \item Phase components appear less frequently; NDVI phase\_h1 arises in the Mediterranean.
\end{itemize}

Summary of patterns:
\begin{itemize}
    \item Seasonal amplitude (first harmonic): |r| $\sim$0.5–0.7 for NDVI or NBR amplitude\_h1 in several regions (e.g., Alps, Oceanic Southwest, Western crystalline).
    \item Baseline spectral properties: |r| $\sim$0.5–0.7 for CRSWIR offset in mountain regions (e.g., Vosges, Jura, Central Massif).
    \item Regional specialization: Western/Atlantic regions emphasize NBR amplitude/offset; Mediterranean adds NDVI phase\_h1.
\end{itemize}

\section{S4. Eco-region Folds, Sampling, and Weights}

Training and evaluation use eco-region–stratified 5-fold CV. Per-sample weights are computed as the inverse of the forest-area fraction per eco-region to balance extensive Atlantic/semi-continental regions with smaller Mediterranean/Alpine regions. Identical folds and weights are shared across harmonics and embeddings to enable fair comparison. Fold manifests and weights are available in the repository’s results directory.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{images/final_snr_map-4.png}
    \caption{\textbf{Figure S2.} Signal-to-noise ratio maps across France for different harmonic configurations. Top row: median SNR; middle row: SNR interquartile range (variability); bottom row: energy distribution in first harmonic. Two harmonics (center column) provides optimal balance between signal capture and noise rejection. Eco-regions numbered as in main text.}
    \label{fig:snr_maps}
\end{figure}

% (Merged similarity summary into S3 above to avoid duplicate numbering.)

% (Single S4 section retained above; removed duplicate header.)

\subsection{Fold Construction}
\begin{itemize}
    \item Training data are built from non-overlapping 2.5\,km tiles (\texttt{results/datasets/tiles\_2\_5\_km\_final.parquet}).
    \item Spatial units: 2.5\,km tiles assigned to exactly one of 5 folds per eco-region (tile-based grouping).
    \item Independence: tiles (and all pixels within) do not cross folds; tuning and feature selection use only training folds to avoid spatial leakage.
    \item Coverage: folds are balanced by forested area per eco-region.
\end{itemize}

\subsection{Sampling and Weights}
\begin{itemize}
    \item Class imbalance handled during training to reflect deciduous/evergreen proportions.
    \item Area-weighted aggregation for national metrics to avoid oversampling larger regions.
    \item Evaluation restricted to the national forest mask.
\end{itemize}

\subsection{Regional Performance Analysis}

\subsubsection{Eco-region Characteristics}
France's 11 eco-regions present diverse challenges:
\begin{itemize}
    \item \textbf{Mediterranean}: Drought stress, evergreen oak dominance, phenological boundary blurring
    \item \textbf{Alps/Pyrenees}: Elevation gradients, conifer-deciduous transitions, topographic effects
    \item \textbf{Atlantic}: Maritime pine plantations, oak-beech forests, clear phenological signals
    \item \textbf{Semi-Continental}: Mixed forests, agricultural fragmentation, strong seasonality
    \item \textbf{Corsica}: Endemic species, complex topography, limited training data
\end{itemize}

\subsubsection{Performance Patterns}
Embedding advantages broadly correlate with environmental complexity:
\begin{itemize}
    \item Continental/western forests: Complex species mixtures benefit from pattern learning.
    \item Mountain regions: Elevation-driven phenology benefits from additional spatial context.
    \item Mediterranean: Drought-adapted phenology reduces separability; explicit temporal modeling remains competitive.
\end{itemize}

\section{S5. Implementation Details}

\subsection{Embedding Feature Extraction}
\begin{enumerate}
    \item Data source: Google Earth Engine \texttt{Satellite Embedding V1 (Annual)} collection (10\,m, 64-D AlphaEarth vectors, 2017--2024) \citep{Google2025SatelliteEmbeddingV1}.
    \item For each study year (2018, 2020, 2022, 2023) we export the tiles at native 10\,m resolution, then clip/mosaic them to the 2.5\,km training grid.
    \item Bands \texttt{A00..A63} are stored as quantized int8 in Earth Engine; values are de-quantized to float32 on read before any feature selection.
    \item No additional normalization or smoothing is applied so that per-pixel embeddings remain comparable across years; downstream feature pruning (EMB-14) happens during cross-validation.
\end{enumerate}
Implementation: \texttt{src/gee/} and \texttt{src/inference/} workflows.

\subsection{Model Configuration}
Random Forest hyperparameters (HalvingGridSearchCV optimized):
\begin{itemize}
    \item \texttt{n\_estimators}: 50, \texttt{max\_depth}: 30
    \item \texttt{min\_samples\_split}: 30, \texttt{min\_samples\_leaf}: 15
    \item \texttt{class\_weight}: balanced (addressing 75\%/25\% imbalance)
\end{itemize}

\subsection{Computational Requirements}
\begin{itemize}
    \item Harmonic extraction: 48 minutes (France, 100×100 km tiles, 80 cores)
    \item Model training: 2 hours (14.1M pixels, 5-fold CV)
    \item Inference: 55 minutes (2+ billion forest pixels)
    \item Memory: 32 GB RAM recommended
    \item Storage: 150 GB intermediate products
\end{itemize}

\subsection{Reproducibility Pointers}
\begin{itemize}
    \item Embedding top-k list: \texttt{results/feature\_selection\_embeddings/features\_embeddings\_topk\_k14.txt}
    \item CV folds/weights: \texttt{results/cv\_folds\_ecoregions.json}
    \item Similarity outputs: \texttt{results/analysis\_similarity/}
\end{itemize}

\section{S6. Validation and Calibration Metrics}

Beyond overall accuracy (92.4\% embeddings, 90.4\% harmonics), detailed metrics reveal model strengths:

\begin{table}[H]
    \centering
    \caption{\textbf{Table S2.} Detailed validation metrics}
    \begin{tabular}{lcc}
        \hline
        \textbf{Metric} & \textbf{Emb-14} & \textbf{Harmonic-14} \\
        \hline
        Producer's accuracy (Deciduous) & 93.5\% & 91.2\% \\
        Producer's accuracy (Evergreen) & 89.1\% & 87.8\% \\
        User's accuracy (Deciduous) & 94.8\% & 93.5\% \\
        User's accuracy (Evergreen) & 90.2\% & 89.1\% \\
        Kappa coefficient & 0.86 & 0.84 \\
        Matthews correlation coefficient & 0.87 & 0.85 \\
        \hline
    \end{tabular}
    \label{tab:validation_metrics}
\end{table}

Both approaches achieve substantial agreement (Kappa > 0.8), with embeddings showing consistent but modest improvements across all metrics.

\subsection{Calibration and Threshold Sensitivity}

We recomputed eco-region-balanced 5-fold cross-validation to extract out-of-fold probabilities for both Random Forest models. Key findings:

\begin{itemize}
    \item \textbf{Expected Calibration Error (ECE)}: Emb-Top14 = 0.033; Harm-Top14 = 0.059 (Maximum Calibration Error 0.114 vs 0.184), confirming that predicted evergreen probabilities closely match observed frequencies.
    \item \textbf{Threshold sweep (0.45/0.50/0.55)}: Embedding macro-F1 spans 0.903–0.906; harmonic macro-F1 spans 0.870–0.879, so modest threshold adjustments barely affect overall balance.
    \item \textbf{Fold variability}: Embedding macro-F1 standard deviation 0.003; harmonic 0.011, indicating smoother behaviour across spatial folds.
\end{itemize}

For users, this means the posterior can be treated as a literal evergreen prevalence: increasing the decision threshold to 0.55 trims evergreen false positives while keeping macro-F1 within 0.003 of the default setting (\(\tau = 0.50\)). Conversely, lowering the threshold to 0.45 recovers additional evergreen pixels with only a marginal cost to deciduous accuracy. Because the histogram mass concentrates near 0 or 1, most pixels are classified with high confidence, and the reliability curves verify that these confident predictions are well grounded.

Reliability histograms (10 bins) and per-threshold confusion counts are available in: \texttt{results/analysis\_calibration/embeddings/}\{\texttt{calibration\_metrics.json}, \texttt{reliability\_curve.csv}\} and \texttt{results/analysis\_calibration/harmonic/}\{\texttt{calibration\_metrics.json}, \texttt{reliability\_curve.csv}\}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.85\textwidth]{images/reliability_comparison.png}
    \caption{\textbf{Figure S3.} Reliability diagrams comparing Emb-Top14 (left) and Harm-Top14 (right) Random Forests. Bars show how many pixels fall in each evergreen-probability bin; the coloured circles plot the model’s average confidence per bin, and the black squares plot the empirical evergreen fraction. Perfect calibration would align the squares with the dashed diagonal. When the coloured circle sits above the black square the forest is slightly over-confident (predicted evergreen rate exceeds reality); the reverse indicates under-confidence. Emb-Top14 stays close to the diagonal (ECE 0.033, MCE 0.114) and concentrates mass near 0 and 1, signalling confident yet reliable predictions. Because macro-F1 remains within 0.903–0.906 when the evergreen threshold moves from 0.50 to 0.45 or 0.55, users can raise the threshold to suppress evergreen false positives or lower it to recover evergreens without destabilising overall accuracy. Residual calibration gaps concentrate around mid-range probabilities (0.4–0.6), where mixed stands and tile edges dominate; the extremes align closely, confirming that the forest cleanly separates pure deciduous and evergreen pixels.}
    \label{fig:reliability}
\end{figure}

The per-eco-region accuracy/F1 deltas that back Table~\ref{tab:eco_region_performance} are stored in \texttt{results/analysis\_coherence/eco\_region\_delta\_metrics.csv} (generated via \texttt{src/analysis/compute\_eco\_region\_deltas.py}).

\subsection{Spatial Coherence Metrics}

To quantify the qualitative differences in map texture, we computed two coherence metrics per tile and aggregated nationally:
\begin{itemize}
    \item \textbf{Edge density} (m km$^{-2}$): total length of class boundaries divided by valid forest area;
    \item \textbf{Patch density} (per 100 km$^{2}$): number of 8-connected deciduous or evergreen patches scaled to 100 km$^{2}$.
\end{itemize}

Patch density relies on connected-component labelling with an 8-neighbour structure. For each tile we count deciduous components \(C_{\text{dec}}\) and evergreen components \(C_{\text{ever}}\), then report
\begin{equation*}
    D_{\text{dec}} = \frac{100\,C_{\text{dec}}}{A}, \qquad
    D_{\text{ever}} = \frac{100\,C_{\text{ever}}}{A}, \qquad
    D_{\text{tot}} = D_{\text{dec}} + D_{\text{ever}},
\end{equation*}
with \(A\) the forest area (km$^2$) within the tile. Smoother maps have few large components and therefore low densities; speckled predictions inflate \(C_{\cdot}\) and consequently \(D_{\cdot}\). The implementation follows `scipy.ndimage.label` with a \(3\times3\) kernel of ones.

As a toy illustration, a 4\(\times\)4 tile containing one three-pixel deciduous block, one three-pixel evergreen block, and a solitary deciduous pixel yields \(C_{\text{dec}}=2\), \(C_{\text{ever}}=1\); if the tile covers \(A=0.25\)~km\(^2\) of forest, the densities become \(D_{\text{dec}} = 800\), \(D_{\text{ever}} = 400\), and \(D_{\text{tot}} = 1{,}200\) patches per 100~km\(^2\). A smoother map with a single deciduous block and a single evergreen block would halve \(D_{\text{tot}}\).

Evaluated over 639 eco-balanced 2.5\,km tiles (sampling the national rasters):

\begin{table}[H]
    \centering
    \caption{\textbf{Table S3.} Spatial coherence (national means).}
    \begin{tabular}{lcc}
        \hline
        \textbf{Variant} & \textbf{Edge density (m km$^{-2}$)} & \textbf{Patch density (per 100 km$^{2}$)} \\ \hline
        Embedding (Top-14) & 3924 & 2925 \\
        Harmonic (Top-14) & 8789 & 8462 \\
        Harmonic + 3\,$\times$\,3 median & 4326 & 3150 \\ \hline
    \end{tabular}
\end{table}

Embeddings produce fewer boundaries and fewer isolated patches than harmonics, consistent with spatial context captured during pre-training. A simple 3\,$\times$\,3 median filter reduces harmonic speckle but embeddings remain ~9\% lower in edge density and ~7\% lower in patch density on average. Implementation and raw outputs are provided by the CLI \texttt{src/analysis/compute\_coherence\_metrics.py}, with summaries in \texttt{results/analysis\_coherence/coherence\_summary.csv}.

\section{S7. Data and Code Availability}

\begin{itemize}
    \item \textbf{Training data}: \texttt{results/datasets/training\_datasets\_pixels.parquet}
    \item \textbf{Models}: \texttt{results/final\_model/}
    \item \textbf{Harmonic extraction}: \texttt{src/features/}
    \item \textbf{Embedding workflows}: \texttt{src/gee/}
    \item \textbf{Similarity analysis}: \texttt{src/analysis/compute\_embedding\_harmonic\_similarity.py}
    \item \textbf{Inference maps}: Available upon publication
\end{itemize}

All code and configurations available at: [repository URL]

\section{S8. References for Foundation Models}

This section collects background references for geospatial foundation models and embedding-based approaches referenced in the main text:

\begin{itemize}
    \item SatMAE pre-training for temporal and multi-spectral satellite imagery \citep{Cong2022}.
    \item Prithvi-EO multi-temporal geospatial foundation models and resources \citep{Szwarcman2024PrithviEO2}.
    \item Billion-scale remote sensing foundation model results across tasks \citep{Cha2023Billion}.
    \item Generative foundation modeling for satellite imagery \citep{Khanna2023DiffusionSat}.
    \item Discussion on when foundation models are effective for pixel-level classification \citep{Xie2024FoundationEffective}.
\end{itemize}

\section{S9. Product Comparisons (DLT, BD For\^{e}t V2)}

We compare the 2023 harmonic-based phenology map against Copernicus DLT (broadleaved vs coniferous) and BD For\^{e}t V2 (deciduous vs evergreen) using per-tile and per-eco-region summaries. Agreement is computed only where both products agree that a pixel is forest. National summary metrics are reported in Table~\ref{tab:product_comparison_national} of the main text.

\subsection{Spatial Agreement Maps}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\textwidth]{images/oa2x2_embeddings_dlt.png}\hfill
    \includegraphics[width=0.49\textwidth]{images/oa2x2_embeddings_bdforet.png}\\[0.5em]
    \includegraphics[width=0.49\textwidth]{images/oa2x2_harmonic_dlt.png}\hfill
    \includegraphics[width=0.49\textwidth]{images/oa2x2_harmonic_bdforet.png}
    \caption{Tile-level agreement (OA, \%) computed where both maps indicate forest. Top: Embeddings vs DLT (left) and BD For\^{e}t (right). Bottom: Harmonics vs DLT (left) and BD For\^{e}t (right). Compact styling and percent colorbars highlight national patterns without clutter.}
    \label{fig:oa2x2_products}
\end{figure}

\subsection{Eco-region Metrics}

The weighted eco-region summaries for both harmonic and embedding comparisons—versus DLT and BD For\^{e}t—are available in \texttt{results/comparison/embeddings\_vs\_dlt\_by\_region.csv}, \texttt{results/comparison/embeddings\_vs\_bdforet\_by\_region.csv}, and their harmonic counterparts. These tables include overall accuracy, kappa, and macro-F1 along with raw class-by-class confusion counts; analysts can slice them directly to build maps or statistics tailored to their regions of interest.

\section{S10. Multiclass Tree Taxa from Embeddings}

We trained Random Forests on the 64‑dimensional annual embeddings to classify tree taxa beyond deciduous–evergreen. At the genus level the model achieves overall accuracy (OA) of 0.828, weighted F1 of 0.829, and macro‑F1 of 0.387. Species‑level performance is lower but still competitive given the long‑tailed label distribution: OA 0.769, weighted F1 0.771, macro‑F1 0.289. Per‑eco‑region means reflect similar patterns (genus: OA 0.805, macro‑F1 0.381; species: OA 0.755, macro‑F1 0.278). These results indicate that embeddings capture taxonomic cues most strongly for dominant classes; tail performance is limited by class imbalance and label sparsity.

\subsection*{Eco‑region Performance}

\begin{table}[H]
    \centering
    \caption{\textbf{Table S4.} Genus classification by eco‑region.}
    \begin{tabular}{lcc}
        \hline
        Eco‑region & OA & Macro F1 \\
        \hline
        Semi-Oceanic North Center & 0.805 & 0.260 \\
        Unknown & 0.947 & 0.407 \\
        Mediterranean & 0.953 & 0.540 \\
        Corsica & 0.821 & 0.490 \\
        Alps & 0.863 & 0.478 \\
        Oceanic Southwest & 0.878 & 0.308 \\
        Greater Crystalline and Oceanic West & 0.697 & 0.317 \\
        Vosges & 0.616 & 0.366 \\
        Jura & 0.787 & 0.316 \\
        Pyrenees & 0.786 & 0.320 \\
        Greater Semi-Continental East & 0.745 & 0.380 \\
        Central Massif & 0.769 & 0.395 \\
        \hline
    \end{tabular}
    \label{tab:genus_ecoregion_embeddings}
\end{table}

\begin{table}[H]
    \centering
    \caption{\textbf{Table S5.} Species classification by eco‑region.}
    \begin{tabular}{lcc}
        \hline
        Eco‑region & OA & Macro F1 \\
        \hline
        Semi-Oceanic North Center & 0.763 & 0.232 \\
        Unknown & 0.897 & 0.521 \\
        Mediterranean & 0.834 & 0.275 \\
        Corsica & 0.746 & 0.297 \\
        Alps & 0.752 & 0.335 \\
        Oceanic Southwest & 0.822 & 0.200 \\
        Greater Crystalline and Oceanic West & 0.574 & 0.214 \\
        Vosges & 0.621 & 0.246 \\
        Jura & 0.783 & 0.237 \\
        Pyrenees & 0.771 & 0.189 \\
        Greater Semi-Continental East & 0.741 & 0.273 \\
        Central Massif & 0.758 & 0.319 \\
        \hline
    \end{tabular}
    \label{tab:species_ecoregion_embeddings}
\end{table}

\subsection*{Notes}
- Dominant taxa attain high F1 (often 0.64–0.90), while rare classes depress macro‑F1.
- Future improvements: class‑balanced sampling and losses, hierarchical genus→species modeling, eco‑region‑aware priors, probability calibration with top‑k reporting, and light spatial regularization.

\bibliographystyle{Frontiers-Harvard}
\bibliography{phenology}

\end{document}
